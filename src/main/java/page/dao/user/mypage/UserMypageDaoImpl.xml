<?xml version="1.0" encoding="UTF-8"?>

<!-- 마이바티스 3 Mapper DOCTYPE -->
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="page.dao.user.mypage.UserMypageDao">

	<select id="selectCnt" parameterType="page.dto.User"
	 resultType="int">
	 	SELECT count(*) FROM usertb
	 	WHERE uemail = #{uemail }
	 	AND upassword = #{upassword }
	 </select>
	 
	 <select id="selectInformationByUemail" parameterType="page.dto.User"
	  resultType="page.dto.User">
	  	SELECT * FROM usertb
	  	WHERE uemail = #{uemail }
	  </select>
	 
	 <update id="update" parameterType="page.dto.User">
	 	UPDATE usertb
	 	SET upassword = #{upassword },
	 		uphone = #{uphone },
	 		uaddress1 = #{uaddress1 },
	 		uaddress2 = #{uaddress2 },
	 		uaddress3 = #{uaddress3 }
	 	WHERE uemail = #{uemail }
	 </update>
	 
	 <delete id="delete" parameterType="page.dto.User">
	 	DELETE usertb
	 	WHERE uemail = #{uemail }
	 </delete>
	 
	 <select id="selectUloginByUemail" parameterType="page.dto.User"
	  resultType="int">
	  	SELECT ulogin FROM usertb
	  	WHERE uemail = #{uemail }
	  </select>
	  
	  <update id="googleUpdate" parameterType="page.dto.User">
	  	UPDATE usertb
	  	SET uphone = #{uphone },
	 		uaddress1 = #{uaddress1 },
	 		uaddress2 = #{uaddress2 },
	 		uaddress3 = #{uaddress3 }
	 	WHERE uemail = #{uemail } 
	  </update>
	  
	  <select id="selectAll" parameterType="page.util.Paging"
	   resultType="page.dto.Question">
	    SELECT * FROM (
	    SELECT rownum rnum, Q.* FROM (
	    SELECT question.*
	    FROM question
	    WHERE 1=1
	    ORDER BY questionno DESC
	    ) Q
	    ORDER BY rnum
	    ) QUESTION
	    WHERE rnum BETWEEN #{startNo} AND #{endNo}	    
	  </select>
	  
	  <select id="selectQuestionnoByDual" resultType="int">
	    SELECT question_seq.nextval FROM dual
	  </select>
	  
	  <select id="selectUsernoByUemail" parameterType="page.dto.User"
	   resultType="int">
	    SELECT userno FROM usertb
	    WHERE uemail = #{uemail }
	   </select>
	   
	   <insert id="insertQuestion" parameterType="page.dto.Question">
	   	INSERT INTO question (questionno, userno, question_title, question_content, pic)
	   	VALUES (#{questionno }, #{userno }, #{question_title }, #{question_content }, #{pic } )
	   </insert>
	   
	   <select id="selectQuestionByQuestionno" parameterType="int"
	    resultType="page.dto.Question">
	     SELECT * FROM question
	     WHERE questionno = #{questionno }
	    </select>
	    
	    <delete id="deleteQuestion" parameterType="page.dto.Question">
	    DELETE question
	    WHERE questionno = #{questionno }
	    </delete>
	    
	    <select id="selectApplicantnoByUserno" parameterType="page.dto.User"
	     resultType="int">
	      SELECT A.applicantno FROM applicant A, usertb U
	      WHERE U.userno = A.userno
	      AND U.userno = #{userno }
	     </select>
	     
	     <select id="selectVolrecord" parameterType="page.dto.Applicant"
	      resultType="page.dto.Volrecord">
	      SELECT * FROM volrecord V, applicant A
	      WHERE A.applicantno = V.applicantno
	      AND A.applicantno = #{applicantno }
	      </select>
	      
	      <select id="selectUnameByUemail" parameterType="page.dto.User"
	       resultType="String">
	       	SELECT uname FROM usertb
	       	WHERE uemail = #{uemail }
	       </select>
	       
	       <select id="selectCntAll" resultType="int">
	       	SELECT count(*) FROM question
	       </select>
</mapper>