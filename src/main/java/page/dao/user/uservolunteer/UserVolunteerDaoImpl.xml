<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="page.dao.user.uservolunteer.UserVolunteerDao">

	<select id="selectVolunteerAll" parameterType="page.util.PagingVolunteer" resultType="page.dto.Volunteer">
		SELECT * FROM (
		SELECT rownum rnum, B.* FROM (
		SELECT volunteer.*
		FROM volunteer
		WHERE 1=1
		<if test="v_process !=null and v_process !='' and v_process != 0 ">
			AND vol_process = #{v_process}
		</if>
		<if test="v_department!=null and v_department!='' ">
			AND department = #{v_department}
		</if>
		<if test="v_area!=null and v_area!='' ">
			AND vol_area = #{v_area}
		</if>
		<if test="v_sterm !=null and v_sterm!='' ">
			<![CDATA[
			AND (vol_sterm <= #{v_sterm} AND vol_sterm <= #{v_eterm} and
			vol_eterm>= #{v_sterm} and vol_eterm>= #{v_eterm}
			OR vol_sterm BETWEEN #{v_sterm} AND #{v_eterm}
			OR vol_eterm BETWEEN #{v_sterm} AND #{v_eterm})
			]]>
		</if>
		<if test="v_sterm !=null and v_sterm!='' ">
			<![CDATA[
			AND (stime <= #{v_stime} AND stime <= #{v_etime} and
			etime>= #{v_stime} and etime>= #{v_etime}
			OR stime BETWEEN #{v_stime} AND #{v_etime}
			OR etime BETWEEN #{v_stime} AND #{v_etime})
			]]>
		</if>
		<if test="search !=null and search !='' and searchno== 1">
			AND vol_title LIKE '%' || #{search} || '%'
		</if>
		ORDER BY volunteerno DESC
		) B
		ORDER BY rnum
		) VOLUNTEER
		WHERE rnum BETWEEN
		#{startNo} AND #{endNo}
	</select>
	
	<select id="selectCntVolunteer" parameterType="page.util.PagingVolunteer" resultType="int">
		SELECT COUNT(*) FROM (
		SELECT rownum rnum, B.* FROM (
		SELECT volunteer.*
		FROM volunteer
		WHERE 1=1
		<if test="v_process !=null and v_process !='' and v_process != 0 ">
			AND vol_process = #{v_process}
		</if>
		<if test="v_department!=null and v_department!='' ">
			AND department = #{v_department}
		</if>
		<if test="v_area!=null and v_area!='' ">
			AND vol_area = #{v_area}
		</if>
		<if test="v_sterm !=null and v_sterm!='' ">
			<![CDATA[
			AND (vol_sterm <= #{v_sterm} AND vol_sterm <= #{v_eterm} and
			vol_eterm>= #{v_sterm} and vol_eterm>= #{v_eterm}
			OR vol_sterm BETWEEN #{v_sterm} AND #{v_eterm}
			OR vol_eterm BETWEEN #{v_sterm} AND #{v_eterm})
			]]>
		</if>
		<if test="v_sterm !=null and v_sterm!='' ">
			<![CDATA[
			AND (stime <= #{v_stime} AND stime <= #{v_etime} and
			etime>= #{v_stime} and etime>= #{v_etime}
			OR stime BETWEEN #{v_stime} AND #{v_etime}
			OR etime BETWEEN #{v_stime} AND #{v_etime})
			]]>
		</if>
		<if test="search !=null and search !='' and searchno== 1">
			AND vol_title LIKE '%' || #{search} || '%'
		</if>
		ORDER BY volunteerno DESC
		) B
		ORDER BY rnum
		) VOLUNTEER
		WHERE rnum BETWEEN
		#{startNo} AND #{endNo}
	</select>
	
<!-- 	<select id="selectVolunteerByNo" parameterType="int" resultType="web.user_page.volunteer.dto.Volunteer"> -->
<!-- 		SELECT * FROM volunteer WHERE volunteerno = #{volunteerno} -->
<!-- 	</select> -->
	
<!-- 	<select id="selectPrtByNo" parameterType="int" resultType="web.user_page.volunteer.dto.Participant"> -->
<!-- 		SELECT participant.applicantno, participant.name, participant.email, participant.date  -->
<!-- 		FROM volunteer WHERE volunteerno = #{volunteerno} -->
<!-- 	</select> -->
	

	
	
</mapper>

