<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="page.dao.center.record.RecordDao">

	<select id="selectCntAll" resultType="int" parameterType="int">
		SELECT count(*) FROM volunteer
		WHERE centerno = #{centerno}
	</select>
	
<!-- 	parameterType="page.util.Paging; int" -->
	
	<select id="selectAllRecord" parameterType="page.util.Paging" resultType="page.dto.Volunteer">
		SELECT * FROM (
		    SELECT rownum rnum, B.* FROM (		
				SELECT 
				v.VOLUNTEERNO VOLUNTEERNO,
				v.CENTERNO CENTERNO,
				v.VOL_PROCESS VOL_PROCESS,
				v.VOL_STERM VOL_STERM,
				v.STIME STIME,
				v.ETIME ETIME,
				v.DEPARTMENT DEPARTMENT,
				v.AREA AREA,
				v.VOL_AREA VOL_AREA,
				v.VOL_PLACE VOL_PLACE,
				v.RECEIVER RECEIVER,
				v.QUALIFICATION QUALIFICATION,
				v.WRITE_DATE WRITE_DATE,
				v.NPEOPLE NPEOPLE,
				v.APEOPLE APEOPLE,
				v.VOL_TITLE VOL_TITLE,
				v.VOL_CONTENT VOL_CONTENT,
				v.VOL_ETERM VOL_ETERM,
				v.VOL_LAT VOL_LAT,
				v.VOL_LNG VOL_LNG,
				v.VOL_ADDRESS VOL_ADDRESS,
				c.CENTERNO CENTERNO_0,
				c.CNAME CNAME,
				c.BUSINESSNO BUSINESSNO,
				c.CPASSWORD CPASSWORD,
				c.MGR MGR,
				c.MEMAIL MEMAIL,
				c.MPHONE MPHONE,
				c.FOUNDED FOUNDED,
				c.CHK CHK,
				c.ADDRESS1 ADDRESS1,
				c.ADDRESS2 ADDRESS2,
				c.ADDRESS3 ADDRESS3,
				a.aname ANAME
				FROM volunteer v, centertb c, area a
				WHERE v.centerno = c.centerno
				AND v.vol_area = a.areano

				<if test="search !=null and search !='' ">
					AND V.vol_title LIKE '%' || #{search} || '%'
				</if>
				
				ORDER BY v.volunteerno DESC
		    ) B
		    ORDER BY rnum
		 ) BOARD
		 WHERE rnum BETWEEN #{startNo} AND #{endNo}				
	</select>

</mapper>